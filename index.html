
<!DOCTYPE html>
<head>
  <title>Mafia Role Generator</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
  <meta content="utf-8" http-equiv="encoding">
  <style>
  .hidden {
    display: none;
  }
  input[type=number]{
    width: 110px;
	} 
  </style>
</head>
<body dir="rtl" style="background: url('img/mafia.jpg') no-repeat center center fixed; -webkit-background-size: cover; -moz-background-size: cover; -o-background-size: cover; background-size: cover;">
  <div style="width:250px; margin:0 auto; color: red;"  id='panel1'>
    <ul id='roleTypes'>
      <li><label><span>رییس مافیا</span>: <input size="10" style="float:left;" type='number' value="1" /></label></li>
      <li><label><span>مافیا</span>: <input style="float:left;" type='number' value="2" /></label></li>
      <li><label><span>کاراگاه</span>: <input style="float:left;" type='number' value = "1" /></label></li>
      <li><label><span>پزشک</span>: <input style="float:left;" type='number' value = "1" /></label></li>
      <li><label><span>شهروند</span>: <input style="float:left;" type='number' value = "2"/></label></li>
      <li><label><span>زره پوش</span>: <input style="float:left;" type='number' value = "1"/></label></li>
      <li><label><span>تک‌تیر انداز</span>: <input style="float:left;" type='number' value = "1"/></label></li>
      <li><label><span>تروریست</span>: <input style="float:left;" type='number' value = "0"/></label></li>
      <li><label><span>غیب گو(ناتو)</span>: <input style="float:left;" type='number' value = "0"/></label></li>
      <li><label><span>گروگان‌گیر</span>: <input style="float:left;" type='number' value = "0"/></label></li>
      <li><label><span>تفنگ دار</span>: <input style="float:left;" type='number' value = "0"/></label></li>
      <li><label><span>نگهبان</span>: <input style="float:left;" type='number' value = "0"/></label></li>
      <li><label><span>تکاور</span>: <input style="float:left;" type='number' value = "0"/></label></li>
    </ul>
    <button onClick='assignRoles()'>دریافت نتایج</button>
  </div>
  <div style="width:300px; margin:0 auto; color: red;"  id='panel2' class='hidden'>
    <ul id='players'>
    </ul>
    <button onClick='newGame()'>بازی جدید</button>
  </div>
  <script>
  function shuffle(array, numberOfshuffles) {
  	for(var i = 0 ; i < numberOfshuffles ; i++){
	    let counter = array.length;

	    // While there are elements in the array
	    while (counter > 0) {
	      // Pick a random index
	      let index = Math.floor(Math.random() * counter);

	      // Decrease counter by 1
	      counter--;

	      // And swap the last element with it
	      let temp = array[counter];
	      array[counter] = array[index];
	      array[index] = temp;
	    }
	}

    return array;
  }

  function assignRoles() {
    var players = []
    var counter = 1;
    for (roleLi of document.getElementById('roleTypes').children) {
      var role = roleLi.children[0].children[0].innerText
      var roleN = roleLi.children[0].children[1].value || 0
      for (var i = 0; i < roleN; i++) players.push(role)
    }
    document.getElementById('players').innerHTML = shuffle(players, 5).map(function (role) {
      return '<li >' + "شماره " + counter++ + " - " +   '<b>' + role + '</b></li>'
    }).join('')
    document.getElementById('panel1').className = 'hidden'
    document.getElementById('panel2').className = ''
  }

  function newGame() {
    if (!confirm('New Game?')) return;
    document.getElementById('panel1').className = ''
    document.getElementById('panel2').className = 'hidden'
  }
  </script>
</body>
</html>
